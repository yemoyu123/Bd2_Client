name: Release Notification

on:
  release:
    types: [published]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord Message
        run: |
          TITLE="${{ github.event.release.name }}"
          if [ -z "$TITLE" ]; then TITLE="${{ github.event.release.tag_name }}"; fi

          curl -H "Content-Type: application/json" \
          -X POST \
          -d '{
                "username": "GitHub Release",
                "avatar_url": "https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png",
                "embeds": [{
                  "title": "ğŸ“¦ å‘ç°æ–°ç‰ˆæœ¬: '"$TITLE"'",
                  "description": "ç‰ˆæœ¬ **${{ github.event.release.tag_name }}** å·²ç»å‘å¸ƒã€‚\n\n[ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹è¯¦æƒ…åŠä¸‹è½½](${{ github.event.release.html_url }})",
                  "url": "${{ github.event.release.html_url }}",
                  "color": 2328202,
                  "fields": [
                    {
                      "name": "åˆ†æ”¯",
                      "value": "`${{ github.event.release.target_commitish }}`",
                      "inline": true
                    },
                    {
                      "name": "å‘å¸ƒäºº",
                      "value": "${{ github.event.release.author.login }}",
                      "inline": true
                    }
                  ],
                  "footer": {
                    "text": "æ¥è‡ª ${{ github.repository }} çš„è‡ªåŠ¨æ›´æ–°"
                  },
                  "timestamp": "'$(date -u +%Y-%m-%dT%H:%M:%SZ)'"
                }]
              }' \
          ${{ secrets.DISCORD_WEBHOOK_URL }}
